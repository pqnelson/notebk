\section{Neo-Ricardian Economics}

\N{Matrix form of equations}
We can express an economy in terms of its input matrix $\mat{A}$, and
its output matrix $\mat{B}$
\begin{equation}
\mat{A}\vec{x}_{n} = \mat{B}\vec{x}_{n+1}
\end{equation}
where $\vec{x}_{n}$ is the stock of commodities at time $t=n$ production
cycles (after some initial production cycle), and $\vec{x}_{n+1}$ is the
stock of commodities \emph{after} the production cycle. We are trying to
find price vectors $\vec{p}$ such that
\begin{equation}
\mat{A}\vec{p} = \mat{B}\vec{p}.
\end{equation}
We assume that, for each sector $i$, the total inputs is no less than
the amount produced
\begin{equation}
\sum_{j=1}^{n}a_{i,j} \leq\sum_{j=1}^{n}b_{i,j}.
\end{equation}
Since usually $\mat{B}$ is diagonal, this simplifies to
\begin{equation*}
\sum_{j=1}^{n}a_{i,j} \leq b_{j,j}.
\end{equation*}
The trick is to first introduce a new vector
\begin{equation}
\vec{q} = \mat{B}\vec{p}\implies \vec{p}=\mat{B}^{-1}\vec{q},
\end{equation}
then rewrite our problem as
\begin{equation}
\mat{A}\vec{p} = \mat{B}\vec{p}\iff \mat{A}\mat{B}^{-1}\vec{q} = \vec{q}.
\end{equation}
For a subsistence economy, when no industry sector has an output, this
is the situation we are trying to solve.

\N{Production with a Surplus}
When at least one industry sector produces more output than is needed
across the entire economy, then there is surplus produced. In this case,
there is a rate of profit $r$, and we are trying to solve the system of
equations:
\begin{equation}
(1+r)\mat{A}\vec{p} = \mat{B}\vec{p}.
\end{equation}
We do the same trick, by writing
\begin{equation}
\vec{q} = \mat{B}\vec{p},
\end{equation}
then plugging this into the equations for an economy with a surplus
gives us
\begin{equation}
(1+r)\mat{A}\vec{p} = \mat{B}\vec{p} \iff (1+r)\mat{A}\mat{B}^{-1}\vec{q}=\vec{q}.
\end{equation}
This is an eigenvalue problem! We divide both sides by $(1+r)$ to find
\begin{equation}
\mat{A}\mat{B}^{-1}\vec{q}=\frac{1}{1+r}\vec{q},
\end{equation}
where $\lambda=1/(1+r)$ is the eigenvalue and $\vec{q}$ is the
eigenvector.

\begin{example}[{Sraffa~\cite[see \S5]{sraffa}}]
  Consider the economy given by the equations of production
  \begin{subequations}
    \begin{align}
      280~\mbox{qr. wheat} + 12~\mbox{t. iron} &\to 575~\mbox{qr. wheat}\\
      120~\mbox{qr. wheat} + 8~\mbox{t. iron} &\to 20~\mbox{t. iron}
    \end{align}
  \end{subequations}
  We have
  \begin{equation}
    \mat{A} = \begin{pmatrix}280 & 12\\
      120 & 8
    \end{pmatrix},
    \quad\mbox{and}\quad
    \mat{B} = \begin{pmatrix}575 & 0\\
      0 & 20
    \end{pmatrix},
  \end{equation}
  and
  \begin{equation}
    \mat{A}\mat{B}^{-1} = \begin{pmatrix}280/575 & 12/20\\
      120/575 & 8/20
    \end{pmatrix}.
  \end{equation}
  We can find the eigenvalues using the characteristic polynomial
  \begin{equation}
p(\lambda) = \left(\frac{280}{575}-\lambda\right)\left(\frac{8}{20}-\lambda\right)-\frac{12}{20}\cdot\frac{120}{575},
  \end{equation}
  which has solutions $\lambda_{1}=2/23$ and $\lambda_{2}=4/5$. These correspond
  to $1+r=23/2$ and $1+r=5/4$ --- or $r=1050\%$ and $r=25\%$, respectively.
  The price vectors are
  \begin{equation}
\vec{p}_{1} = p_{w}\begin{pmatrix}1\\-115/6
\end{pmatrix},\quad\mbox{and}\quad\vec{p}_{2}= p_{w}\begin{pmatrix}1\\15
\end{pmatrix}.
  \end{equation}
  The viable price vector is $\vec{p}_{2}$ where the price of 1 ton of iron
  $p_{i}$ is equal to the price of 15 quarters of wheat, $p_{i}=15p_{w}$.
\end{example}


\begin{example}[{Sraffa~\cite[see \S25]{sraffa}}]
  Consider the more complicated equations of production:
  \begin{subequations}
    \begin{align}
      200~\mbox{qr. wheat} + 40~\mbox{t. iron} + 40~\mbox{t. coal} &\to 480~\mbox{qr. wheat}\\
      60~\mbox{qr. wheat} + 90~\mbox{t. iron} + 120~\mbox{t. coal} &\to 180~\mbox{t. iron}\\
      150~\mbox{qr. wheat} + 50~\mbox{t. iron} + 125~\mbox{t. coal} &\to 450~\mbox{t. coal}
    \end{align}
  \end{subequations}
  Observe the inputs are 410 qr wheat, 285 tons coal, 180 tons iron. We
  can compute the product $\mat{A}\mat{B}^{-1}$ as
  \begin{equation}
\mat{A}\mat{B}^{-1} = \begin{pmatrix}
  (5/12) & (2/9) & (4/45)\\
  (1/8) & (1/2) & (4/15)\\
  (5/16) & (5/18) & (5/18)
\end{pmatrix}.
  \end{equation}
  This has characteristic polynomial
\begin{equation}
p(\lambda) = \frac{35}{1296} - \frac{\lambda}{3} + \frac{43}{36}\lambda^{2}-\lambda^{3}.
\end{equation}
  We find its eigenvalues are $\lambda_{1}=5/6$, $\lambda_{2}=7/36$, and
  $\lambda_{3}=1/6$ which correspond to rates of profit $r_{1}=1/5$,
  $r_{2}=29/7$, and $r_{3}=5$.%%  The rates of profit $r_{2}$ and $r_{3}$
%%   lead to negative prices, so $r_{1}$ is the economically realistic rate
%%   of profit. The exchange rate is
%%   \begin{equation}
%% 8~\mbox{qr.\ wheat} = 11~\mbox{t.\ iron} = 10~\mbox{t.\ coal}
%%   \end{equation}

  If we consider $r_{1}=1/5$ as the rate of profit, the first equation
\begin{subequations}
  \begin{equation}
(6/5)(200p_{w} + 40 p_{i} + 40 p_{c}) = 480p_{w}
  \end{equation}
  may be rewritten as
  \begin{equation}
40p_{w} + 8p_{i} + 8p_{c} = 80p_{w}
  \end{equation}
  which reduces to
  \begin{equation}\label{eq:appendix-sraffa:system-2:wheat-sector}
p_{i} + p_{c} = 5p_{w}.
  \end{equation}
\end{subequations}
Now if we look at the second equation,
\begin{subequations}
  \begin{equation}
(6/5)(60p_{w} + 90 p_{i} + 120 p_{c}) = 180p_{i}
  \end{equation}
  which simplifies to
  \begin{equation}
12p_{w} + 18p_{i} + 24p_{c} = 30p_{i},
  \end{equation}
  which gives us
  \begin{equation}
p_{w} + 2p_{c} = p_{i}.
  \end{equation}
\end{subequations}
But if we add $p_{c}$ to both sides,
\begin{equation}
p_{w} + 3p_{c} = p_{i} + p_{c},
\end{equation}
we can use Eq~\eqref{eq:appendix-sraffa:system-2:wheat-sector} to
rewrite the right-hand side as
\begin{equation}
p_{w} + 3p_{c} = 5p_{w},
\end{equation}
hence
\begin{equation}
\boxed{p_{c} = \frac{4}{3}p_{w}.}
\end{equation}
If we plug this back into Eq~\eqref{eq:appendix-sraffa:system-2:wheat-sector}
we find
\begin{equation}
\boxed{p_{i} = \frac{11}{3}p_{w}.}
\end{equation}
Or if we want it in one big equation
\begin{equation}
\boxed{11p_{c} = 4p_{i} = \frac{44}{3}p_{w}.}
\end{equation}

We briefly mention the other choices of the rate of profit leads to
negative prices. For example, if we took $r_{3}$, the first equation of
production gives us
\begin{subequations}
\begin{equation}
6(200p_{w} + 40p_{i} + 40p_{c}) = 480p_{w}
\end{equation}
which simplifies to
\begin{equation}
5p_{w} + p_{i} + p_{c} = 2p_{w}
\end{equation}
and thus
\begin{equation}
p_{i} + p_{c} = -3p_{w}.
\end{equation}
\end{subequations}
If $p_{w}>0$, then either $p_{i}<0$ or $p_{c}<0$. If $p_{w}<0$, then $p_{w}<0$.
Either way, we have negative prices.

For $r_{2}=29/7$, we would have
\begin{subequations}
\begin{equation}
(36/7)(200p_{w}+40p_{i}+40p_{c}) = 480p_{w}
\end{equation}
which reduces to
\begin{equation}
(36/7)(5p_{w}+p_{i}+p_{c}) = 12p_{w},
\end{equation}
or equivalently
\begin{equation}
35p_{w} + 7p_{i} + 7p_{c} = \frac{1}{3}p_{w}
\end{equation}
hence
\begin{equation}
7p_{i} + 7p_{c} = -\frac{104}{3}p_{w}.
\end{equation}
\end{subequations}
And we're in exactly the same situation as before, we must have a
negative price.
\end{example}

\N{Numerical values}
A lot of these examples have nice numerical values. But if we, for
example, reduced the surplus of the wheat sector to zero in the previous
example, giving us the equations of production:
  \begin{subequations}
    \begin{align}
      200~\mbox{qr. wheat} + 40~\mbox{t. iron} + 40~\mbox{t. coal} &\to 410~\mbox{qr. wheat}\\
      60~\mbox{qr. wheat} + 90~\mbox{t. iron} + 120~\mbox{t. coal} &\to 180~\mbox{t. iron}\\
      150~\mbox{qr. wheat} + 50~\mbox{t. iron} + 125~\mbox{t. coal} &\to 450~\mbox{t. coal}
    \end{align}
  \end{subequations}
  Then the matrix $\mat{A}\mat{B}^{-1}$ has characteristic polynomial
  \begin{equation}
p(\lambda) = \frac{35}{1107} - \frac{1679}{4428}\lambda + \frac{467}{369}\lambda^{2}-\lambda^{3}.
  \end{equation}
  The closed form expression for the eigenvalues is rather unpleasant
  and shockingly involves imaginary quantities
\begin{subequations}
\begin{align}
\lambda_{1} &= \frac{467}{1107}+\frac{252805}{2214 \sqrt[3]{118352413+738\I\sqrt{3946737549}}}
+\frac{\sqrt[3]{118352413+738\I\sqrt{3946737549}}}{2214}
\end{align}
\begin{multline}
\lambda_{2} = \frac{467}{1107}
-\frac{252805}{4428 \sqrt[3]{118352413+738 \I\sqrt{3946737549}}}
-\frac{252805\I}{1476 \sqrt{3} \sqrt[3]{118352413+738\I\sqrt{3946737549}}}\\
-\frac{\sqrt[3]{118352413+738\I\sqrt{3946737549}}}{4428}\
+\frac{\I\sqrt[3]{118352413+738\I\sqrt{3946737549}}}{1476 \sqrt{3}}
\end{multline}
\begin{multline}
  \lambda_{3} = \frac{467}{1107}
  -\frac{252805}{4428 \sqrt[3]{118352413+738\I\sqrt{3946737549}}}
  +\frac{252805\I}{1476 \sqrt{3}\sqrt[3]{118352413+738\I\sqrt{3946737549}}}\\
  -\frac{\sqrt[3]{118352413+738\I\sqrt{3946737549}}}{4428}
  -\frac{\I \sqrt[3]{118352413+738\I\sqrt{3946737549}}}{1476 \sqrt{3}}
\end{multline}
\end{subequations}
  There is no closed form expression for the eigenvalues of
$\mat{A}\mat{B}^{-1}$ \emph{as real numbers}. We need to use numerical
  approximations:
  \begin{subequations}
    \begin{align}
      \lambda_{1} &\approx0.872546\\
      \lambda_{2} &\approx0.147691\\
      \lambda_{3} &\approx0.245346.
    \end{align}
  \end{subequations}
  Only $\lambda_{1}$ corresponds to a rate of profit between 0 and 100\%
  (namely, a rate of profit $r_{1}\approx0.146072$). This gives the
  exchange rate of
  \begin{equation}
p_{i}(\lambda_{1})\approx2.85062p_{w},\quad\mbox{and}\quad
p_{c}(\lambda_{1})\approx1.09298p_{w}.
  \end{equation}
If we tried the other rates of profit, we would find 
  \begin{equation}
    p_{i}(\lambda_{2})\approx-3.2122p_{w},\quad\mbox{and}\quad
    p_{c}(\lambda_{2})\approx0.726998p_{w},
  \end{equation}
  which is implausible; and lastly
  \begin{equation}
    p_{i}(\lambda_{3})\approx-6.33286p_{w},\quad\mbox{and}\quad
    p_{c}(\lambda_{3})\approx2.84669p_{w}.
  \end{equation}
  Again, this last case is implausible.


  \N{Perturbing Coal surplus, supply and demand}
  Suppose we restore the surplus of wheat.
  If we parametrize the surplus of coal as a variable $\Delta c$, then the
  equations of production become:
  \begin{subequations}
    \begin{align}
      200~\mbox{qr. wheat} + 40~\mbox{t. iron} + 40~\mbox{t. coal} &\to 480~\mbox{qr. wheat}\\
      60~\mbox{qr. wheat} + 90~\mbox{t. iron} + 120~\mbox{t. coal} &\to 180~\mbox{t. iron}\\
      150~\mbox{qr. wheat} + 50~\mbox{t. iron} + 125~\mbox{t. coal} &\to (285+\Delta c)~\mbox{t. coal}
    \end{align}
  \end{subequations}
  We see that as $\Delta c$ increases, the value of coal (as measured in its
  exchange-rate with wheat) decreases. We perform these calculations,
  at increments of $\Delta c=10$ tons of coal, and find:
  \begin{center}
    \begin{tabular}{cccc}
      \toprule
      &\multicolumn{2}{c}{Value of 1 ton of coal}&\\
      \cmidrule(r){2-3}
    $\Delta c$ & $p_{c}$ in multiples of $p_{w}$ & $p_{c}$ in multiples of $p_{i}$&rate of profit\\ \midrule
 $0$ & $ 2.39536 p_{w}$ & $ 0.57506 p_{i}$ & $3.79928\%$\\
$10$ & $ 2.28951 p_{w}$ & $ 0.555297 p_{i}$ & $3.93706\%$\\
$20$ & $ 2.19192 p_{w}$ & $ 0.536871 p_{i}$ & $4.07416\%$\\
$30$ & $ 2.10173 p_{w}$ & $ 0.519652 p_{i}$ & $4.2106\%$\\
$40$ & $ 2.01814 p_{w}$ & $ 0.503524 p_{i}$ & $4.34639\%$\\
$50$ & $ 1.94051 p_{w}$ & $ 0.488387 p_{i}$ & $4.48152\%$\\
$60$ & $ 1.86823 p_{w}$ & $ 0.474151 p_{i}$ & $4.616\%$\\
$70$ & $ 1.80081 p_{w}$ & $ 0.460739 p_{i}$ & $4.74984\%$\\
$80$ & $ 1.73777 p_{w}$ & $ 0.448081 p_{i}$ & $4.88303\%$\\
$90$ & $ 1.67874 p_{w}$ & $ 0.436114 p_{i}$ & $5.0156\%$\\
$100$ & $ 1.62335 p_{w}$ & $ 0.424783 p_{i}$ & $5.14753\%$\\
    \bottomrule
  \end{tabular}
  \end{center}
  We see as the surplus of coal $c$ increases, its exchange rate with
  iron and wheat decreases. In other words, \emph{as supply increases, price decreases}.
  That is to say, the ``law of supply'' is an emergent phenomenon in
  Neo-Ricardian economics.

  The curious reader may experiment with the Mathematica code used to
  produce this table:
\begin{Verbatim}
inverse_profit[c_]:=Eigenvalues[{{200/480,40/180,40/(285+c)},
 {60/480,90/180,120/(285+c)},
 {150/480,50/180,125/(285+c)}}]

prices[c_,profit_]:=Reduce[{profit*(60 wheat + 90 iron + 120 coal) == 180 iron,
 profit*(150 wheat + 50 iron + 125 coal) == (285 + c) coal},
 {iron, coal}]

exchange[c_] := prices[c, 1/(inverse_profit[c])[[1]]]

Table[{10*c,
   N[exchange[10*c]][[2]][[2]],
   N[exchange[10*c]][[2]][[2]]/N[exchange[10*c]][[1]][[2]] iron,
   N[(1/inverse_profit[c] - 1)[[1]]},
 {c,0,10}]
\end{Verbatim}
The \verb#inverse_profit# produces a list of eigenvalues for
$\mat{A}\mat{B}^{-1}$, the first eigenvalue corresponds to the
economically significant solution. We then find the exchange-rate of
iron, wheat, and coal using \verb#prices#, and finally produce a
\verb#Table# of rows consisting of $\Delta c$, the price of 1 ton of
coal in terms of the value of wheat $p_{w}$, and the price of 1 ton of
coal in terms of the value of iron $p_{i}$.