\section{Scalar Field}

\M
We have the Klein--Gordon field\index{Klein--Gordon!Field}
be described by the Lagrangian in
Eq~\eqref{eq:classical-field-theory:linear-chain:continuum-limit:mass-term:lagrangian}.
More generally, since we could add an arbitrary potential term
$V(\varphi)$, the Lagrangian looks like:
\begin{equation}\label{eq:classical-field-theory:scalar-field:lagrangian}
\begin{split}
  \mathcal{L} &= -\frac{1}{2}\partial^{\mu}\varphi\partial_{\mu}\varphi
-\frac{1}{2}\frac{m^{2}c^{2}}{\hbar^{2}}\varphi^{2} - V(\varphi)\\
&=\frac{1}{2}c^{-2}(\partial_{t}\varphi)^{2}-\frac{1}{2}(\nabla\varphi)^{2}
-\frac{1}{2}\frac{m^{2}c^{2}}{\hbar^{2}}\varphi^{2} - V(\varphi).
\end{split}
\end{equation}
Our physical intuition should be that of a linear chain of
point-particles connected by massless identical springs, as we have
analyzed in the previous section.

\begin{exercise}
Can we interpret the $\frac{1}{2}(\nabla\varphi)^{2}$ term in the
Lagrangian as a contribution to the potential? If so, what is its
physical interpretation?
\end{exercise}

\begin{definition}\index{Klein--Gordon!Field}\index{Field!Scalar!Free}\index{Scalar Field!Free}
When $V=0$ in the Lagrangian, we call the type of field a
\define{Klein--Gordon Field} (or \emph{Free Scalar Field}).
\end{definition}

\begin{remark}
We could have $V(\varphi) = a + b\varphi + c\varphi^{2}$ and reabsorb
$a$, $b$, $c$ into the mass and elsewhere in the Lagrangian, producing
an equivalent free scalar field. And physicists will be a little sloppy
in their language, referring to such Lagrangians with
nonzero-but-quadratic potentials as ``free''.
\end{remark}

\begin{definition}
When $V(\varphi)\neq0$ (and specifically $V(\varphi)$ is not a constant,
or a linear or quadratic polynomial), we say we have a
\define{Self-Interacting Scalar Field}.
\end{definition}

\begin{definition}
When we have a linear $\varphi$ term in the Lagrangian's potential term
(something like $\sigma\varphi$), we refer to it as an
\define{External Source}.
\end{definition}

\begin{remark}
This terminology may seem bizarre at first, but it generalizes the
4-current which we used to recover Maxwell's equations (\S\ref{chunk:relativity:electromagnetism:recovering-maxwell-equations}).
The 4-current captured our intuition of coupling electromagnetism to
matter (``charged particles''), and the external source couples the
field to ``generic matter''.

We will also find, however, that it's useful to stick in an external
source into the Lagrangian for mathematical purposes. It's a
mathematical trick where we will differentiate with respect to external
sources to compute moments of integrals, then set the external source to
zero. 
\end{remark}

\N{Goals}
We will study the \emph{free} scalar field in this section. 

\N{Abuse of Language}\index{Field!Equations}
When working with fields, we will often use the terms ``field
equations'' and ``equations of motion'' interchangeably. This is
following the convention physicists adhere.

\N{Variational Analysis}
We consider a region $\mathcal{R}\subset\RR^{3,1}$, usually taken to be
$\RR^{3}\times[t_{1},t_{2}]$ for some $t_{1}<t_{2}$. Now we will
consider the action
\begin{equation}
\action[\varphi] = \int_{\mathcal{R}}\left(\frac{1}{2}c^{-2}(\partial_{t}\varphi)^{2}-\frac{1}{2}(\nabla\varphi)^{2}
-\frac{1}{2}\frac{m^{2}c^{2}}{\hbar^{2}}\varphi^{2}\right)\D^{3}\vec{x}\,\D t.
\end{equation}
As usual, we will try to find the critical points of the action, and
argue these are the physical solutions to the equations of motion.

Now, we take a variation of this action with respect to $\varphi$. This
is done by writing
\begin{equation}
\varphi_{\lambda} = \varphi + \lambda\psi,
\end{equation}
where $\lambda$ is a real parameter, $\psi|_{\partial\mathcal{R}}=0$ is
an (otherwise) arbitrary function. Physicists write
\begin{equation}
\delta\varphi = \lambda\psi,
\end{equation}
and pretend $\lambda$ is an infinitesimal quantity $\lambda^{2}\ll1$.
Then expanding the integrand in the action to first-order in $\lambda\psi$,
we demand the coefficient to $\lambda\psi$ vanish. We find,
\begin{calculation}
\action[\varphi_{\lambda}]
\step{plugging in the definition of the action}
\int_{\mathcal{R}}\left(\frac{1}{2}c^{-2}(\partial_{t}\varphi_{\lambda})^{2}-\frac{1}{2}(\nabla\varphi_{\lambda})^{2}
-\frac{1}{2}\frac{m^{2}c^{2}}{\hbar^{2}}\varphi_{\lambda}^{2}\right)\D^{3}\vec{x}\,\D t
\step{unfold the definition of $\varphi_{\lambda}$}
\int_{\mathcal{R}}\left(\frac{1}{2}c^{-2}(\partial_{t}[\varphi + \lambda\psi])^{2}-\frac{1}{2}(\nabla[\varphi + \lambda\psi])^{2}
-\frac{1}{2}\frac{m^{2}c^{2}}{\hbar^{2}}[\varphi + \lambda\psi]^{2}\right)\D^{3}\vec{x}\,\D t
%% \step{expand}
%% \int_{\mathcal{R}}\left(\frac{1}{2}c^{-2}
%% (\partial_{t}\varphi)^{2}+c^{-2}\partial_{t}\varphi\partial_{t}\psi+\frac{1}{2}c^{-2}(\partial_{t}\psi)^{2}
%% -\frac{1}{2}(\nabla\varphi)^{2}
%% -(\nabla\varphi)\cdot(\nabla(\lambda\psi))
%% -\frac{1}{2}(\nabla(\lambda\psi))\cdot(\nabla(\lambda\psi))
%% -\frac{1}{2}\frac{m^{2}c^{2}}{\hbar^{2}}[\varphi^{2} + 2\lambda\psi\varphi + \lambda^{2}\psi^{2}]\right)\D^{3}\vec{x}\,\D t
\step{expanding and collecting coefficients of $\lambda$}
\action[\varphi] + \int_{\mathcal{R}}\left(
c^{-2}\partial_{t}\varphi\partial_{t}(\lambda\psi)
-(\nabla\varphi)\cdot(\nabla(\lambda\psi))
-\frac{m^{2}c^{2}}{\hbar^{2}}\varphi\cdot(\lambda\psi)\right)\D^{3}\vec{x}\,\D t
+\action[\lambda\psi].
\end{calculation}
We write the first variation of the action as:
\begin{equation}
\delta\action[\varphi_{\lambda}] = \int_{\mathcal{R}}\left(
c^{-2}\partial_{t}\varphi\partial_{t}(\lambda\psi)
-(\nabla\varphi)\cdot(\nabla(\lambda\psi))
-\frac{m^{2}c^{2}}{\hbar^{2}}\varphi\cdot\lambda\psi\right)\D^{3}\vec{x}\,\D t.
\end{equation}

\N{Initial conditions}
We need to specify the initial and final configuration for the scalar
field, so for $\mathcal{R}=\mathcal{R}_{3}\times[t_{1},t_{2}]\subset\RR^{3,1}$,
we need functions
\begin{equation}
\varphi_{1},\varphi_{2}\colon\mathcal{R}_{3}\to\RR,
\end{equation}
such that
\begin{equation}
\varphi|_{\mathcal{R}_{3}\times\{t_{1}\}}=\varphi_{1},\quad\mbox{and}\quad
\varphi|_{\mathcal{R}_{3}\times\{t_{2}\}}=\varphi_{2}.
\end{equation}

\M
We can integrate $\delta\action[\varphi_{\lambda}]$ by parts (with
respect to time) to get
\begin{equation}
\delta\action[\varphi_{\lambda}] = \int_{\mathcal{R}}\left(
-c^{-2}(\lambda\psi)\partial_{t}^{2}\varphi
-(\nabla\varphi)\cdot(\nabla(\lambda\psi))
-\frac{m^{2}c^{2}}{\hbar^{2}}\varphi\cdot\lambda\psi\right)\D^{3}\vec{x}\,\D t.
\end{equation}
The boundary terms from this integration-by-parts vanishes since
$\lambda\psi|^{t_{2}}_{t_{1}}=0$.

\M
When we have $\mathcal{R}=\RR^{3}\times[t_{1},t_{2}]$, we treat
$\RR^{3}$ as a sphere with radius $r\to\infty$. Doing so allows us to
use the divergence theorem to further rewrite the first variation of the
action as, when $\vec{n}$ is the outward-pointing unit normal vector,
\begin{equation}
\begin{split}
\delta\action[\varphi_{\lambda}] &= \int_{\mathcal{R}}\left(
-c^{-2}(\lambda\psi)\partial_{t}^{2}\varphi
+(\lambda\psi)\nabla^{2}\varphi
-\frac{m^{2}c^{2}}{\hbar^{2}}\varphi\cdot\lambda\psi\right)\D^{3}\vec{x}\,\D t\\
&\qquad-\int^{t_{2}}_{t_{1}}\int_{r\to\infty}(\lambda\psi)\vec{n}\cdot(\nabla\varphi)%
\,\D A\,\D t,
\end{split}
\end{equation}
where $\D A$ is the differential area for the sphere. (In $n+1$
dimensions, $\D A\sim r^{n-2}\,\D r$.)
We have implicitly used the fact that
\begin{equation}
(\nabla\varphi)\cdot\nabla(\lambda\psi)=\nabla\cdot((\nabla\varphi)\lambda\psi)
-(\lambda\psi)\nabla^{2}\varphi,
\end{equation}
before using the divergence theorem.

\N{Assumption on growth of field}
We need to assume that, at a fixed time $t$, the scalar field $\varphi$
(and therefore both $\varphi_{\lambda}$ and $\lambda\psi$) fall off as
$r\to\infty$ sufficiently fast so as to make the boundary term in the
first variation of the action $\delta\action$ vanishes. One possibility
is to work with fields with compact support.

The usual assumption physicists make is that, since the area eleement
$\D A$ grows like $r^{2}$, the integrand must fall faster than $1/r^{2}$
as $r\to\infty$ for the boundary term to vanish.

More generally, in $n+1$ dimensional spacetime, $\D A$ grows like $r^{n-1}$,
requiring the integrand to fall faster than $1/r^{n-1}$ as $r\to\infty$
for the boundary terms to vanish.

\M
Now we see that the first variation of the action is just
\begin{subequations}
\begin{equation}
\delta\action[\varphi] = \int_{\mathcal{R}}\left(
-c^{-2}(\lambda\psi)\partial_{t}^{2}\varphi
+(\lambda\psi)\nabla^{2}\varphi
-\frac{m^{2}c^{2}}{\hbar^{2}}\varphi\cdot\lambda\psi\right)\D^{3}\vec{x}\,\D t,
\end{equation}
or factoring out the $\delta\varphi=\lambda\psi$,
\begin{equation}
\delta\action[\varphi] = \int_{\mathcal{R}}\left(
-c^{-2}\partial_{t}^{2}\varphi
+\nabla^{2}\varphi
-\frac{m^{2}c^{2}}{\hbar^{2}}\varphi\right)\delta\varphi\,\D^{3}\vec{x}\,\D t.
\end{equation}
\end{subequations}
Now we need to find the critical points of the action, which is to say,
we demand $\delta\action[\varphi]=0$. This gives us a rather tricky
differential-integral equation, but fortunately the fundamental lemma of
variational calculus\marginnote{TODO: cite fundamental lemma of variational calculus} says the condition is exactly demanding the
integrand's coefficient of $\delta\varphi$ vanishes, i.e.,
\begin{equation}
\boxed{-c^{-2}\partial_{t}^{2}\varphi
+\nabla^{2}\varphi
-\frac{m^{2}c^{2}}{\hbar^{2}}\varphi=0.}
\end{equation}
Solving this differential equation gives us the critical point for the
action.

Usually we expedite this whole process of variational analysis, and just
use the Euler--Lagrange equations.

\begin{exercise}
Re-perform this analysis with an arbitrary potential contribution
$V(\varphi)$ and observe how the equations of motion change (i.e., what
extra term will be added to the equations of motion, something involving
$V'(\varphi)$ we expect).
\end{exercise}

\N{Equations of Motion}
We can now derive the equations of motion using the Euler--Lagrange
equations, which are:
\begin{equation}
c^{-2}\partial_{t}^{2}\varphi - \nabla^{2}\varphi + \frac{m^{2}c^{2}}{\hbar^{2}}\varphi+V'(\varphi)=0.
\end{equation}
Also note that $V(\varphi)$ is usually some polynomial in $\varphi$, and
we can discard the terms lower than quadratic order (and absorb the
quadratic term into the mass term).

\begin{proof}
  We have
  \begin{subequations}
  \begin{equation}
\frac{\partial\mathcal{L}}{\partial(\partial_{\mu}\varphi)}
=-\partial^{\mu}\varphi,
  \end{equation}
  so the ``acceleration'' part of the equations of motion:
  \begin{equation}
\partial_{\mu}\frac{\partial\mathcal{L}}{\partial(\partial_{\mu}\varphi)}
=-\partial_{\mu}\partial^{\mu}\varphi.
  \end{equation}
  Then the ``force'' part of the equations of motion
\begin{equation}
\frac{\partial\mathcal{L}}{\partial\varphi} = -\frac{m^{2}c^{2}}{\hbar^{2}}\varphi
- V'(\varphi).
\end{equation}
Taken altogether, the equations of motion read:
\begin{equation}
-\partial_{\mu}\partial^{\mu}\varphi = -\frac{m^{2}c^{2}}{\hbar^{2}}\varphi
- V'(\varphi).
\end{equation}
  \end{subequations}
  Some gentle messaging yields the result.
\end{proof}

\N{Solutions}
We can solve the equations of motion for the \emph{free} scalar field by
taking its Fourier transform. We have
\begin{equation}
\varphi(t,\vec{x}) = \iint\E^{-\I(\omega t-\vec{k}\cdot\vec{x})}\widetilde{\varphi}(\omega,\vec{k})\frac{\D^{3}\vec{k}}{(2\pi\hbar)^{3}}\frac{\D\omega}{2\pi\hbar}
\end{equation}
where $\widetilde{\varphi}$ is the Fourier transform, $\omega=E/\hbar$,
and $\vec{k}=\vec{p}/\hbar$.

\begin{exercise}
Explicitly work this out. I mean, it's \emph{obvious}, but you should
check that it's \emph{true}.
\end{exercise}

\begin{exercise}
Let us consider the Fourier transform in the spatial variables only for
the scalar field,
\begin{equation}
\widetilde{\varphi}(\vec{k},t) = \int\E^{\I(\vec{k}\cdot\vec{x})}\varphi(\vec{x},t)\D^{3}\vec{x}.
\end{equation}
Prove or find a counter-example: the complex conjugate of the
\emph{spatially} Fourier
transformed scalar field $\widetilde{\varphi}(\vec{k},t)^{*}$
satisfies $\widetilde{\varphi}(\vec{k},t)^{*}=\widetilde{\varphi}(-\vec{k},t)$.

Also: do we need to include a factor of $(2\pi)^{-3/2}$ in the spatial Fourier
transform, or will things work out fine as we presented it? 
\end{exercise}

\subsection{Aside: Variational Calculus}

\M
We will typically use some heuristics in physics when doing variational
calculus, rather than working with the level of rigour anyone would hope
for. Given some functional of the form
\begin{equation}
F[\varphi] = \int_{\mathcal{R}}f(\varphi(x), \partial_{\mu}\varphi(x))\,\D^{4}x,
\end{equation}
we consider its first variation with respect to $\varphi$ by pretending:
\begin{enumerate}
\item $\delta$ is a linear operator obeying the Leibniz product rule (i.e., it
is a derivation), and
\item variations commute with differentiation (e.g., $\delta(\partial_{\mu}\varphi)=\partial_{\mu}(\delta\varphi)$).
\end{enumerate}
So to be clear, in the integrand, the $\delta$ operator acts like:
\begin{equation}
\delta f(\varphi(x)) 
= \frac{\partial f(\varphi)}{\partial\varphi}\delta\varphi.
\end{equation}
When there are also derivatives of $\varphi$, we have
\begin{subequations}
\begin{align}
\delta f(\varphi(x),\partial_{\mu}\varphi) 
&= \frac{\partial f(\varphi,\partial_{\mu}\varphi)}{\partial\varphi}\delta\varphi
+ \frac{\partial f(\varphi,\partial_{\mu}\varphi)}{\partial(\partial_{\mu}\varphi)}\delta(\partial_{\mu}\varphi)\\
\intertext{or, commuting variation with partial derivatives in the second term,}
\delta f(\varphi(x),\partial_{\mu}\varphi) &= \frac{\partial f(\varphi,\partial_{\mu}\varphi)}{\partial\varphi}\delta\varphi
+ \frac{\partial f(\varphi,\partial_{\mu}\varphi)}{\partial(\partial_{\mu}\varphi)}\partial_{\mu}(\delta\varphi)
\end{align}
\end{subequations}
When computing these partial derivatives, we pretend
\begin{equation}
\frac{\partial(\partial_{\mu}\varphi)}{\partial\varphi}
=0,\quad\mbox{and}\quad
\frac{\partial\varphi}{\partial(\partial_{\mu}\varphi)}=0.
\end{equation}

Then we have
\begin{equation}
\delta F[\varphi] = \int\left(\frac{\partial f}{\partial\varphi}\delta\varphi
+\frac{\partial f}{\partial(\partial_{\mu}\varphi)}\delta(\partial_{\mu}\varphi)\right)\,\D^{4}x.
\end{equation}
We try to integrate by parts to rewrite the integrand as
\begin{equation}
\delta F[\varphi] = \begin{pmatrix}\mbox{boundary}\\\mbox{terms}
\end{pmatrix}
+ \int\mbox{(something)}\delta\varphi\,\D^{4}x,
\end{equation}
then using the fundamental lemma of
variational calculus to set $\mbox{(something)}=0$. For most problems in
physics, we discard the boundary terms.\footnote{General Relativity is a
notable example where boundary terms are important.} This will give us a
differential equation whose solution is a critical point of the
functional.

\M
For multiple fields $\varphi_{a}$ with $a=1,\dots,N$, we need to take
the variation with respect to each of these fields. The first variation
would require summing over $a$, giving us $N$ coefficients of
$\delta\varphi_{a}$ (one for each $a$). We need each coefficient to
separately vanish, giving us a system of $N$ equations.

\M
These heuristics aren't ``wrong'', they just sweep details under the
rug. Specifically we would have
$\varphi_{a}^{(\lambda)}=\varphi_{a}+\lambda_{a}\psi_{a}$ where
$\psi_{a}$ are arbitrary functions which vanish at the initial and final
time slices. Then for any functional $F[\varphi_{a}]$ we find its first
variation as
\begin{equation}
\left.\frac{\D}{\D\lambda}F[\varphi^{(\lambda)}_{a}]\right|_{\lambda=0}=\delta
F[\varphi_{a},\psi_{a}]=\int\sum_{a}\frac{\delta F}{\delta\varphi_{a}}\psi_{a}\,\D^{4}x,
\end{equation}
where we just abuse notation left and right, using
$\delta F/\delta\varphi_{a}$ for the integrand, and sometimes writing
$\delta\varphi_{a}$ instead of $\psi_{a}$, and so on.

\begin{ddanger}
The notation used here is horribly sloppy in the physics literature, and
we have chosen to be consistent with that literature as much as possible.
The notation for a functional derivative coincides with a variational
derivative, which is horribly unfortunate. Some physicists try to relate
the two, but it's not quite the same thing.
\end{ddanger}

\N{Conditions for a minimum}
We recall from calculus in a single variable that not all critical
points of a function are minima (sometimes they are maxima, or
inflection points, or something else). This should caution us from being
too optimistic about critical points of functionals: the critical points
are \emph{candidates} for the minima, but we must check they are minima.

In calculus, this involves examining the sign of
$f''(x_{\text{crit}})$. When $f''(x_{\text{crit}})>0$, we have a
[possibly local] minimum.

For functionals, we need to examine the second variation $\delta^{2}F$
at the critical point. Specifically, for variation $\varphi_{\text{crit}}+\lambda\psi$,
we need
\begin{equation}
\delta^{2}F[\varphi_{\text{crit}}+\psi]\geq k\|\psi\|^{2}
\end{equation}
for all $\psi$ and some constant $k>0$. This is completely analogous to
the situation in calculus. Here we have (Taylor expanding in $\lambda\psi$, integrating by parts,
so the integrand is a Taylor polynomial in $\lambda\psi$):
\begin{equation}
F[\varphi+\lambda\psi] = F[\varphi] + \int\left(\frac{\delta F}{\delta\varphi}\lambda\psi
+\frac{\delta^{2} F}{\delta\varphi^{2}}\lambda^{2}\psi^{2} + \bigOh(\lambda^{3}\psi^{3})\right)\D^{n}x.
\end{equation}
Then we have 
\begin{equation}
\delta^{2}F[\varphi+\lambda\psi] = \int\frac{\delta^{2} F}{\delta\varphi^{2}}\lambda^{2}\psi^{2}\,\D^{n}x.
\end{equation}
This is the \define{Second Variation} of $F$.

However, this is all rather tedious, and in practice physicists drop the
``Mission Accomplished'' banner upon finding critical points for
functionals.

\begin{ddanger}
Not all functionals have a second variation. We need it to be twice
differentiable. For the functionals we care about in physics, which is
just the integral of a Lagrangian, we can compute the second variation.
\end{ddanger}

\subsection{Hamiltonian Formalism}

\M
The Hamiltonian formalism for fields follows roughly the same plan,
regardless of which Lagrangian we're working with. We recall the basic
steps in canonical analysis:
\begin{enumerate}
\item Determine the conjugate momenta $p_{i}$ for the positions $q^{i}$
\item Write the velocities in terms of the momenta $\dot{q}^{i}=\dot{q}^{i}(q,p)$
\item Perform the Legendre transform to write the Hamiltonian $H=p_{i}\dot{q}^{i}-L(q^{j},\dot{q}^{j}(q,p))$.
\item Transform the action or use the Poisson brackets.
\end{enumerate}
These steps are, more or less, the same for fields, except we work with
densities (intuitively describing each ``point mass'' in the linear chain). 

\N{Conjugate Momenta Density}
We define the conjugate momenta density by
\begin{equation}
\pi(\vec{x},t) := \frac{\partial\mathcal{L}}{\partial(\partial_{t}\varphi)}(\vec{x},t).
\end{equation}
If there are $n$ fields $\varphi_{a}$ for $a=1,\dots,n$, then we have
$n$ conjugate momenta:
\begin{equation}
\pi_{a}(\vec{x},t) := \frac{\partial\mathcal{L}}{\partial(\partial_{t}\varphi_{a})}(\vec{x},t).
\end{equation}
Heuristically $\pi_{a}\sim\partial_{t}\varphi_{a}$, modulo some constants.

\begin{ddanger}
When we have a field enjoy some symmetry or gauge invariance, the
momenta densities may not be independent of each other. More generally,
there may be some redundancies in the description of the phase space,
and we need to impose some constraints. This happens in
Electromagnetism, Yang--Mills theory, General Relativity, and any other
fields with gauge symmetry. Whenever we have some field equations which
do not involve the time derivatives of the field (e.g., the Gauss law in
Electromagnetism), then we have some constraints.
\end{ddanger}

\begin{example}
For the free scalar field (and self-interacting scalar fields), we have
\begin{calculation}
\pi(\vec{x},t)
\step{definition of conjugate momenta density}
\frac{\partial\mathcal{L}}{\partial(\partial_{t}\varphi)}(\vec{x},t)
\step{using the definition of the Lagrangian density for scalar fields, Eq~\eqref{eq:classical-field-theory:scalar-field:lagrangian}}
\frac{\partial}{\partial(\partial_{t}\varphi)}\left(\frac{1}{2}c^{-2}(\partial_{t}\varphi)^{2}-\frac{1}{2}(\nabla\varphi)^{2}
-\frac{1}{2}\frac{m^{2}c^{2}}{\hbar^{2}}\varphi^{2} - V(\varphi)\right)
\step{linearity, plus only terms involving $\partial_{t}\varphi$ contribute}
\frac{\partial}{\partial(\partial_{t}\varphi)}\left(\frac{1}{2}c^{-2}(\partial_{t}\varphi)^{2}\right)
+ 0
\step{power rule for differentiation}
c^{-2}\partial_{t}\varphi(\vec{x},t).
\end{calculation}
Hence for scalar fields
\begin{equation}
\boxed{\pi(\vec{x},t) = c^{-2}\partial_{t}\varphi(\vec{x},t).}
\end{equation}
\end{example}

\M
We can, for scalar fields, write the ``velocities'' in terms of momenta
densities as:
\begin{equation}
\partial_{t}\varphi(\vec{x},t) = c^{2}\pi(\vec{x},t).
\end{equation}

\N{Legendre Transform}
We obtain the Hamiltonian density for the scalar field by
\begin{calculation}
\mathcal{H}
\step{Legendre transform}
\pi(\vec{x},t)\partial_{t}\varphi(\vec{x},t) - \mathcal{L}
\step{plug in definition of Lagrangian density, Eq~\eqref{eq:classical-field-theory:scalar-field:lagrangian}}
\pi(\vec{x},t)\partial_{t}\varphi(\vec{x},t) - \left(\frac{1}{2}c^{-2}(\partial_{t}\varphi)^{2}-\frac{1}{2}(\nabla\varphi)^{2}
-\frac{1}{2}\frac{m^{2}c^{2}}{\hbar^{2}}\varphi^{2} - V(\varphi)\right)
\step{plug in $\partial_{t}\varphi=c^{2}\pi$}
c^{2}\pi(\vec{x},t)^{2} - \left(\frac{1}{2}c^{-2}(c^{2}\pi(\vec{x},t))^{2}-\frac{1}{2}(\nabla\varphi)^{2}
-\frac{1}{2}\frac{m^{2}c^{2}}{\hbar^{2}}\varphi^{2} - V(\varphi)\right)
\step{algebra}
\frac{c^{2}}{2}\pi(\vec{x},t)^{2} -
+\frac{1}{2}(\nabla\varphi)^{2} +\frac{1}{2}\frac{m^{2}c^{2}}{\hbar^{2}}\varphi^{2} + V(\varphi).
\end{calculation}
This gives us the Hamiltonian density in terms of the canonical variables.

\N{Poisson Bracket}\index{Poisson bracket}
We will derive the Poisson bracket for fields in analogy to the
heuristic motivation of functional differentiation (see
Section~\ref{section:math:functional-derivatives}). If we had a large
number of point-particles, we would have the Poisson bracket be
\begin{equation}
\PoissonBracket{A}{B}
  = \sum_{i}\frac{\partial A}{\partial q^{i}}\frac{\partial B}{\partial p_{i}}
- \frac{\partial B}{\partial q^{i}}\frac{\partial A}{\partial p_{i}}.
\end{equation}
Then for fields, we take ``the continuum limit'', giving us:
\begin{equation}
\PoissonBracket{A}{B}
= \int\left(\frac{\delta A}{\delta\varphi(\vec{x}',t)}\frac{\delta B}{\delta\pi(\vec{x}',t)}
-\frac{\delta B}{\delta\varphi(\vec{x}',t)}\frac{\delta A}{\delta\pi(\vec{x}',t)}\right)\D^{n}x'.
\end{equation}
Here the primed variables indicate we are using some ``fresh'' dummy
variable. 
For a finite collection of fields $\varphi^{a}(\vec{x},t)$ with
conjugate momenta $\pi_{a}(\vec{x},t)$, the Poisson bracket:
\begin{equation}
\PoissonBracket{A}{B}
= \int\sum_{a}\left(\frac{\delta A}{\delta\varphi^{a}(\vec{x}',t)}\frac{\delta B}{\delta\pi_{a}(\vec{x}',t)}
-\frac{\delta B}{\delta\varphi^{a}(\vec{x}',t)}\frac{\delta A}{\delta\pi_{a}(\vec{x}',t)}\right)\D^{n}x'.
\end{equation}
As a quick consistency check, let us compute the Poisson bracket of a
field with its conjugate momenta:
\begin{calculation}
\PB{\varphi(\vec{x},t)}{\pi(\vec{y},t)}
\step{definition of Poisson bracket}
\int\left(\frac{\delta\varphi(\vec{x},t)}{\delta\varphi(\vec{x}',t)}\frac{\delta\pi(\vec{y},t)}{\delta\pi(\vec{x}',t)}
-\frac{\delta\pi(\vec{y},t)}{\delta\varphi(\vec{x}',t)}\frac{\delta\varphi(\vec{x},t)}{\delta\pi(\vec{x}',t)}\right)\D^{n}x'
\step{since $\delta\varphi/\delta\pi=\delta\pi/\delta\varphi=0$}
\int\left(\frac{\delta\varphi(\vec{x},t)}{\delta\varphi(\vec{x}',t)}\frac{\delta\pi(\vec{y},t)}{\delta\pi(\vec{x}',t)}\right)\D^{n}x'
\step{since $\delta\varphi(\vec{x})/\delta\varphi(\vec{x}')=\delta^{(n)}(\vec{x}-\vec{x}')$
by Example~\ref{ex:math:functional-derivative:delta-f-over-delta-f-is-delta-fun}}
\int\left(\delta^{(n)}(\vec{x}-\vec{x}')\frac{\delta\pi(\vec{y},t)}{\delta\pi(\vec{x}',t)}\right)\D^{n}x'
\step{since $\delta\pi(\vec{y})/\delta\pi(\vec{x}')=\delta^{(n)}(\vec{y}-\vec{x}')$
by Example~\ref{ex:math:functional-derivative:delta-f-over-delta-f-is-delta-fun}}
\int\left(\delta^{(n)}(\vec{x}-\vec{x}')\delta^{(n)}(\vec{y}-\vec{x'})\right)\D^{n}x'
\step{defining property of delta function}
\delta^{(n)}(\vec{x}-\vec{y}).
\end{calculation}

\begin{exercise}
When we have $n$ fields, $\varphi_{a}$, show
$\PB{\varphi^{a}(\vec{x},t)}{\pi_{b}(\vec{y},t)}=\delta^{a}_{b}\delta^{(n)}(\vec{x}-\vec{y})$.
\end{exercise}

\begin{exercise}
Prove $\PB{AB}{C}=\PB{A}{C}B+A\PB{B}{C}$ and $\PB{A}{BC}=\PB{A}{B}C+B\PB{A}{C}$.
\end{exercise}

\begin{exercise}
Prove $\PB{c_{1}A+c_{2}B}{C}=c_{1}\PB{A}{C}+c_{2}\PB{B}{C}$ for any
constants $c_{1}$, $c_{2}$.
\end{exercise}

\begin{exercise}
Prove $\PB{A}{B}=-\PB{B}{A}$.
\end{exercise}


\begin{exercise}[{Teitelboim~\cite{Teitelboim:1980hs}}]
When there are $k$ fields $\varphi^{A}$ and their conjugate momenta
$\pi_{A}$, letting $i$, $j=1,\dots,n$ be ``spatial'' indices and $A$,
$B$, $C=1,\dots,k$ be the ``field'' indices, summing over any repeated index, compute:
\begin{enumerate}
\item $\PB{\varphi^{A}(\vec{x},t)}{a_{i}^{B}(\varphi^{C}(\vec{y},t))\pi_{B}(\vec{y},t)}$
where $a_{i}^{B}(\varphi^{C}(\vec{y},t))$ is ``some sufficiently smooth function'' of the fields;
\item $\PB{\pi_{A}(\vec{x},t)}{a_{i}^{B}(\varphi^{C}(\vec{y},t))\pi_{B}(\vec{y},t)}$
\item $\PB{a_{i}^{B}(\varphi^{C}(\vec{x},t))\pi_{B}(\vec{x},t)}{~a_{i}^{B}(\varphi^{C}(\vec{y},t))\pi_{B}(\vec{y},t)}$
\item $\PB{\varphi^{A}(\vec{x},t)}{b_{i}^{jB}(\varphi^{C}(\vec{y},t))\partial_{j}\pi_{B}(\vec{y},t)}$
where $b_{i}^{jB}(\varphi^{C}(\vec{y},t))$ is ``some sufficiently smooth function'' of the fields;
\item $\PB{\pi_{A}(\vec{x},t)}{b_{i}^{jB}(\varphi^{C}(\vec{y},t))\partial_{j}\pi_{B}(\vec{y},t)}$
\item $\PB{b_{i}^{jB}(\varphi^{C}(\vec{x},t))\partial_{j}\pi_{B}(\vec{x},t)}{~b_{i}^{jB}(\varphi^{C}(\vec{y},t))\partial_{j}\pi_{B}(\vec{y},t)}$
\item $\PB{a_{i}^{B}(\varphi^{C}(\vec{x},t))\pi_{B}(\vec{x},t)}{~b_{i}^{jB}(\varphi^{C}(\vec{y},t))\partial_{j}\pi_{B}(\vec{y},t)}$
\end{enumerate}
\end{exercise}

\N{Hamilton's Equations}\index{Hamilton's equations}
We can use the Poisson bracket to determine the equations of motion for
the field and its conjugate momenta:
\begin{subequations}\label{eq:classical-field-theory:scalar-field:poisson-bracket:eom}
\begin{align}
\partial_{t}\varphi(\vec{x},t) &= \PB{\varphi(\vec{x},t)}{H}\\
\partial_{t}\pi(\vec{x},t)     &= \PB{\pi(\vec{x},t)}{H},
\end{align}
\end{subequations}
where the Hamiltonian is just the integral of the Hamiltonian density
over all space,
\begin{equation}
H = \int_{\RR^{3}}\mathcal{H}\bigl(\varphi(\vec{x}',t), \pi(\vec{x}',t)\bigr)\,\D^{3}x'.
\end{equation}

\begin{exercise}
From Eq~\eqref{eq:classical-field-theory:scalar-field:poisson-bracket:eom}
and the Poisson brackets, prove the field analogue of the Hamilton equations:
\begin{equation}
\partial_{t}\varphi(\vec{x},t) = \frac{\delta H}{\delta\varphi(\vec{x},t)},
\quad\mbox{and}\quad
\partial_{t}\pi(\vec{x},t) = -\frac{\delta H}{\delta\pi(\vec{x},t)}.
\end{equation}
\end{exercise}

\subsection{*Symplectic Structure}

\M
We can equip the set $\Gamma$ of solutions to the field equations with
some extra geometric structure, like we do in Hamiltonian
mechanics when working with a Lagrangian with explicit time dependence.
Specifically we equip $\Gamma$ with some Symplectic structure $\Omega_{ab}$.
We will define $(\Gamma,\Omega)$ as the phase space, and construct the
Hamiltonian $H\colon\Gamma\to\RR$.

\subsubsection*{Review of Symplectic Mechanics}

\M % N{Review of Symplectic Mechanics}
In mechanics, recall we have the configuration space describe the
positions $q^{i}$. From the Lagrangian $L(q^{i},\dot{q}^{i})$, assuming
it is ``sufficiently nice''\footnote{Specifically this means it is
``regular'', i.e., its Hessian matrix with respect to velocities $\partial^{2}L/\partial\dot{q}^{i}\partial\dot{q}^{j}$
is an invertible matrix. In other words, the Jacobian matrix for
changing velocities into momenta $\partial p_{i}/\partial\dot{q}^{j}$ is
invertible. This is not true for Electromagnetism, Yang--Mills, General
Relativity, and any other system with gauge symmetries.}, we have the
variational identity
\begin{equation}
\variation L = \mathcal{E}_{i}\,\variation q^{i} + \frac{\D}{\D t}\theta
\end{equation}
where $\mathcal{E}_{i}$ are the Euler--Lagrange equations for $q^{i}$,
\begin{equation}
\mathcal{E}_{i} = \frac{\partial L}{\partial q^{i}}
-\frac{\D}{\D t}\frac{\partial L}{\partial\dot{q}^{i}},
\end{equation}
and then we have the ``boundary terms'' (arising from integration by parts),
\begin{equation}\label{eq:classical-field-theory:hamiltonian:symplectic-form:theta}
\theta = \frac{\partial L}{\partial\dot{q}^{i}}\delta q^{i}.
\end{equation}
Observe that $\theta$ is a function of $q^{i}$, $\dot{q}^{i}$, and
linearly depends on $\delta q^{i}$.

\M
We then define $\Gamma$ to be the solutions to the Euler--Lagrange
equations $\mathcal{E}_{i}=0$. The points of $\Gamma$ are solutions $q^{i}(t)$.
Tangent vectors to $\Gamma$ at a point defined by the solution $q^{i}(t)$
are formally taken as the variations $\variation q^{i}(t)$, which are
solutions to the linear system of equations obtained by linearizing the
Euler--Lagrange equations about the solution $q^{i}(t)$.

\N{Symplectic Form}
We can now assemble the Symplectic form on $\Gamma$ from $\theta$ in Eq~\eqref{eq:classical-field-theory:hamiltonian:symplectic-form:theta}.
If we imagine $\theta$ as the value of a one-form $\Theta$ on a tangent
vector $\variation q^{i}(t)$ to $\Gamma$,\marginnote{Symplectic Potential $\Theta$}\index{Symplectic!Potential}
\begin{equation}
\theta = \Theta(\variation q).
\end{equation}
Then the Symplectic two-form is constructed as\index{Symplectic!Form}
\begin{equation}
\Omega = \D\Theta.
\end{equation}
We usually call $\Theta$ the \define{Symplectic Potential}.
In local coordinates, this acts on a pair of tangent vectors $\variation_{1}q^{i}(t)$
and $\variation_{2}q^{i}(t)$ at the point of $\Gamma$ specified by
$q^{i}(t)$ by
\begin{equation}
\begin{split}
\Omega(\variation_{1}q^{i}(t),\variation_{2}q^{i}(t))
&=\frac{\partial^{2}L}{\partial\dot{q}^{i}\partial q^{j}}(\variation_{1}q^{j}(t)\variation_{2}q^{i}(t)-\variation_{1}q^{i}(t)\variation_{2}q^{j}(t))\\
&\qquad+\frac{\partial^{2}L}{\partial\dot{q}^{i}\partial\dot{q}^{j}}(\variation_{1}\dot{q}^{j}(t)\variation_{2}q^{i}(t)-\variation_{1}q^{i}(t)\variation_{2}\dot{q}^{j}(t)),
\end{split}
\end{equation}
where we evaluate $q^{i}(t)$ and $\dot{q}^{i}(t)$ at the given solution,
and all instances of $\variation q(t)$ are evaluated at solutions of the
equations of motion linearized about $q(t)$.

\begin{definition}
Let $H\colon\Gamma\to\RR$ be the Hamiltonian on the Symplectic space $(\Gamma,\Omega)$.
We define the \define{Hamiltonian Vector Field} as the vector field $X$
on $\Gamma$ defined by
\begin{equation}
X = \Omega^{-1}(-,\D H).
\end{equation}
The integral curves of $X$ correspond to the time-translations of the solutions.
\end{definition}

\begin{theorem}
Suppose we are working with a system whose Lagrangian is not explicitly
time-dependent $L=L(q,\dot{q})$.
Then canonical energy function,
\begin{equation}
E = \dot{q}^{i}\frac{\partial L}{\partial\dot{q}^{i}}-L,
\end{equation}
generates the time translations of points of $\Gamma$.
\end{theorem}

This will be exploited in field theory.

\begin{proof}[Proof sketch]
Our claim, our proof obligation, can be stated as:
\begin{equation}
\Omega(\variation q, X) = \D E(\variation q),
\end{equation}
where $\variation q$ is any solution to the linearized equations and $X$
defines the linearized solution defined by infinitesimal time
translation (this is where $L$ not explicitly depending on time is crucial):
\begin{equation}
X = \dot{q}^{i}.
\end{equation}
How to prove it?

We compute the left-hand side of our goal,
\begin{equation}\label{eq:classical-field-theory:scalar-field:symplectic-form:pf-step:lhs-of-pf-goal}
\Omega(\variation q, X)
= \frac{\partial^{2}L}{\partial\dot{q}^{i}\partial q^{j}}
(\dot{q}^{i}\,\variation q^{j}-\dot{q}^{j}\,\variation q^{i})
+\frac{\partial^{2}L}{\partial\dot{q}^{i}\partial\dot{q}^{j}}
(\dot{q}^{j}\,\variation\dot{q}^{i}-\ddot{q}^{i}\,\variation q^{j}).
\end{equation}
Compare this to the right-hand side of our goal, after some massaging,
\begin{equation}
\D E(\variation q)= \frac{\partial^{2}L}{\partial\dot{q}^{i}\partial q^{j}}\dot{q}^{i}\,\variation q^{j}
+\frac{\partial^{2}L}{\partial\dot{q}^{i}\partial\dot{q}^{j}}\dot{q}^{i}\,\variation\dot{q}^{j}
-\frac{\partial L}{\partial q^{i}}\variation q^{i}.
\end{equation}
Now we work on the third term,
\begin{calculation}
-\frac{\partial L}{\partial q^{i}}\variation q^{i}
\step{using the Euler--Lagrange equations}
-\variation q^{i}\frac{\D}{\D t}\frac{\partial L}{\partial\dot{q}^{i}}
\step{expand the total time derivative}
-\variation q^{i}\left(\dot{q}^{j}\frac{\partial^{2} L}{\partial\dot{q}^{i}\partial q^{j}}
+\ddot{q}^{j}\frac{\partial^{2} L}{\partial\dot{q}^{i}\partial\dot{q}^{j}}\right).
\end{calculation}
When we plug this back into our manipulation of the right-hand side of
our proof obligation,
\begin{equation}
\D E(\variation q)= \frac{\partial^{2}L}{\partial\dot{q}^{i}\partial q^{j}}\dot{q}^{i}\,\variation q^{j}
+\frac{\partial^{2}L}{\partial\dot{q}^{i}\partial\dot{q}^{j}}\dot{q}^{i}\,\variation\dot{q}^{j}
-\variation q^{i}\left(\dot{q}^{j}\frac{\partial^{2} L}{\partial\dot{q}^{i}\partial q^{j}}
+\ddot{q}^{j}\frac{\partial^{2} L}{\partial\dot{q}^{i}\partial\dot{q}^{j}}\right).
\end{equation}
And look, after invoking distributivity, this is precisely our left-hand side of our proof obligation
in Eq~\eqref{eq:classical-field-theory:scalar-field:symplectic-form:pf-step:lhs-of-pf-goal}.
\end{proof}

\M
The familiar physics textbooks that even having passing discussions on
this typically have an expedited discussion of all this. When the dust
settles, we have the canonically conjugate momenta,
\begin{equation}
p_{i} = \frac{\partial L}{\partial\dot{q}^{i}},
\end{equation}
then we have
\begin{equation}
\Theta = p_{i}\,\D q^{i}\,\qquad\Omega=\D p_{i}\wedge\D q^{i}.
\end{equation}
This is usually passed over in silence, though.

\begin{exercise}[{Torre~\cite{Torre:2022}}]
  Recall the simple harmonic oscillator's Lagrangian
  \begin{equation}
L = \frac{1}{2}m\dot{q}^{2} - \frac{1}{2}m\omega^{2}q^{2}.
  \end{equation}
  Compute its Symplectic structure when we parametrize its space of
  solutions by:
  \begin{enumerate}
  \item $q(t) = A\cos(\omega t) + B\sin(\omega T)$.
  \item $q(t) = a\exp(-\I\omega t) + a^{*}\exp(\I\omega t)$ where
    $a\in\CC$ and $a^{*}$ is its complex conjugate.
  \end{enumerate}
\end{exercise}

\subsubsection*{Symplectic Formalism for Fields}

\M
Recall the Lagrangian density for a (possibly self-interacting) scalar field is:
\begin{subequations}
\begin{equation}
\mathcal{L} = \frac{1}{2}\bigl((\partial_{t}\varphi)^{2} - (\nabla\varphi)^{2}
-(\mu\varphi)^{2}\bigr) - V(\varphi),
\end{equation}
and the Lagrangian is,
\begin{equation}
L = \int_{\RR^{3}}\mathcal{L}\,\D^{3}x.
\end{equation}
We have shown the variational identity
\begin{equation}
\variation\mathcal{L} = \bigl(-\partial_{t}^{2}\varphi +
\nabla^{2}\varphi - \mu^{2}\varphi - V'(\varphi)\bigr)\,\variation\varphi + \partial_{\mu}W^{\mu},
\end{equation}
where we can explicitly choose:
\begin{equation}
W^{0} = (\partial_{t}\varphi)\,\variation\varphi,\qquad W^{i}=-(\partial^{i}\varphi)\,\variation\varphi.
\end{equation}
\end{subequations}

\N{Phase Space}
We now let the phase space $\Gamma$ be a suitably nice\footnote{For
example, smooth solutions with compactly supported initial data.} function space of
solutions $\varphi$ to the Euler--Lagrange equations,
\begin{equation}
\partial_{\mu}\partial^{\mu}\varphi - \mu^{2}\varphi - V'(\varphi)=0.
\end{equation}

\N{Symplectic Potential}
Assuming (as usual) the solutions vanish at spatial infinity, the
variational identity for the Lagrangian evaluated on $\Gamma$ reads:
\begin{equation}
\variation L = \frac{\D}{\D t}\int_{\RR^{3}}W^{0}\,\D^{3}x.
\end{equation}
Then we define the Symplectic potential one-form $\Theta$ by its linear
action on $\variation\varphi$ (a tangent vector to $\Gamma$):
\begin{equation}
\Theta(\variation\varphi) = \int_{\RR^{3}}W^{0}\,\D^{3}x =  \int_{\RR^{3}}(\partial_{t}\varphi)\,\variation\varphi\,\D^{3}x.
\end{equation}

\N{Symplectic Structure}
We now have the Symplectic two-form evaluated on a pair of tangent
vectors $\variation_{1}\varphi$, $\variation_{2}\varphi$ to the same
solution $\varphi$ is given by
\begin{equation}\label{eq:classical-field-theory:scalar-field:symplectic-structure:explicit-defn}
\Omega(\variation_{1}\varphi, \variation_{2}\varphi)
=\int_{\RR^{3}}\bigl((\partial_{t}\variation_{2}\varphi)\variation_{1}\varphi
-(\partial_{t}\variation_{1}\varphi)\variation_{2}\varphi\bigr)\,\D^{3}x.
\end{equation}
There may be concerns that this requires a separate $\Omega$ for each
moment of time $t$, i.e., we have \emph{infinitely many} $\Omega$
instead of a [suitably] unique $\Omega$. However, this is not the case,
since its derivative with respect to time vanishes.

\begin{proposition}
  We have
  \begin{equation}
\frac{\D}{\D t}\Omega(\variation_{1}\varphi, \variation_{2}\varphi)=0.
  \end{equation}
\end{proposition}

\begin{proof}
We can compute the time derivative directly,
\begin{calculation}
\frac{\D}{\D t}\Omega(\variation_{1}\varphi, \variation_{2}\varphi)
\step{using Eq~\eqref{eq:classical-field-theory:scalar-field:symplectic-structure:explicit-defn}}
\frac{\D}{\D t}\int_{\RR^{3}}\bigl((\partial_{t}\variation_{2}\varphi)\variation_{1}\varphi
-(\partial_{t}\variation_{1}\varphi)\variation_{2}\varphi\bigr)\,\D^{3}x
\step{sweep time derivative inside the integral}
\int_{\RR^{3}}\bigl((\partial_{t}^{2}\variation_{2}\varphi)\variation_{1}\varphi
+(\partial_{t}\variation_{2}\varphi)(\partial_{t}\variation_{1}\varphi)
-(\partial_{t}^{2}\variation_{1}\varphi)\variation_{2}\varphi
-(\partial_{t}\variation_{1}\varphi)(\partial_{t}\variation_{2}\varphi)\bigr)\,\D^{3}x
\step{subtract out equal terms}
\int_{\RR^{3}}\bigl((\partial_{t}^{2}\variation_{2}\varphi)\variation_{1}\varphi
-(\partial_{t}^{2}\variation_{1}\varphi)\variation_{2}\varphi\bigr)\,\D^{3}x.
\end{calculation}
That is,
\begin{equation}\label{eq:classical-field-theory:scalar-field:symplectic-structure:explicit-defn:intermediate-proof-step}
\frac{\D}{\D t}\Omega(\variation_{1}\varphi, \variation_{2}\varphi)
=\int_{\RR^{3}}\bigl((\partial_{t}^{2}\variation_{2}\varphi)\variation_{1}\varphi
-(\partial_{t}^{2}\variation_{1}\varphi)\variation_{2}\varphi\bigr)\,\D^{3}x.
\end{equation}
Now, the tangent vectors to $\Gamma$ each satisfy the linearization of
the equations of motion about a solution $\varphi$:
\begin{equation}
\Box\variation\varphi - \mu^{2}\variation\varphi - V''(\varphi)\,\variation\varphi=0.
\end{equation}
This means that,
\begin{equation}
\partial_{t}^{2}\variation\varphi=\nabla^{2}\variation\varphi - (\mu^{2}+V''(\varphi))\,\variation\varphi.
\end{equation}
Returning to Eq~\eqref{eq:classical-field-theory:scalar-field:symplectic-structure:explicit-defn:intermediate-proof-step},
we can continue manipulating the time derivative of the Symplectic structure,
\begin{calculation}
\frac{\D}{\D t}\Omega(\variation_{1}\varphi, \variation_{2}\varphi)
\step{plugging in Eq~\eqref{eq:classical-field-theory:scalar-field:symplectic-structure:explicit-defn:intermediate-proof-step}}
\int_{\RR^{3}}\bigl((\partial_{t}^{2}\variation_{2}\varphi)\variation_{1}\varphi
-(\partial_{t}^{2}\variation_{1}\varphi)\variation_{2}\varphi\bigr)\,\D^{3}x
\step{using the linearized solution to the linearized equations of motion}
\int_{\RR^{3}}\bigl((\nabla^{2}\variation_{2}\varphi- (\mu^{2}+V''(\varphi))\,\variation_{2}\varphi)\variation_{1}\varphi
-(\nabla^{2}\variation_{1}\varphi- (\mu^{2}+V''(\varphi))\,\variation_{1}\varphi)\variation_{2}\varphi\bigr)\,\D^{3}x
\step{subtracting out equal terms}
\int_{\RR^{3}}\bigl((\nabla^{2}\variation_{2}\varphi)\variation_{1}\varphi
-(\nabla^{2}\variation_{1}\varphi)\variation_{2}\varphi\bigr)\,\D^{3}x
\step{divergence theorem}
\int_{\RR^{3}}\bigl((\nabla\variation_{2}\varphi)\cdot(\nabla\variation_{1}\varphi)
-(\nabla\variation_{1}\varphi)\cdot(\nabla\variation_{2}\varphi)\bigr)\,\D^{3}x
+\mbox{(boundary terms)}
\step{since linearized solutions vanish asymptotically}
\int_{\RR^{3}}\bigl((\nabla\variation_{2}\varphi)\cdot(\nabla\variation_{1}\varphi)
-(\nabla\variation_{1}\varphi)\cdot(\nabla\variation_{2}\varphi)\bigr)\,\D^{3}x
\step{since the integrand is identically zero}
0.
\end{calculation}
Hence the result.
\end{proof}

\N{Parametrizing Phase Space by Initial Data}
We have implicitly assumed the phase space $\Gamma$ is suitably nice and
has some obvious parametrization. Often it will be useful to suppose the
solutions to the field equations are, in fact, solutions to well-posed
initial value problems: for every pair of functions on $\RR^{3}$,
$(\phi(\vec{x}),\varpi(\vec{x})$ there exists a unique solution $\varphi(t,\vec{x})$
such that at a given initial time $t=t_{0}$ we have:
\begin{equation}
\varphi(t_{0},\vec{x})=\phi(\vec{x}),\qquad c^{2}\partial_{t}\varphi(t_{0},\vec{x})=\varpi(\vec{x}.
\end{equation}
Therefore, from this perspective, we may view a point of the phase space
$\Gamma$ as ``just'' a pair of functions $(\phi,\varpi)$ on $\RR^{3}$.

Using this particular parametrization of solutions, a tangent vector
takes the form $(\variation\phi,\variation\varpi)$ to a point
$(\phi,\varpi)$, and we have
\begin{equation}
\Theta(\variation\phi,\variation\varpi)=\int_{\RR^{3}}\varpi\,\variation\phi\,\D^{3}x,
\end{equation}
and
\begin{equation}
\Omega((\variation\phi_{1},\variation\varpi_{1}),\;
(\variation\phi_{2},\variation\varpi_{2}))
=\int_{\RR^{3}}(\variation_{2}\varpi\,\variation_{1}\phi-\variation_{1}\varpi\,\variation_{2}\phi)\,\D^{3}x.
\end{equation}
These should remind the reader of the formulas from mechanics
$\Theta=p_{i}\,\D q^{i}$ and $\Omega=\D p_{i}\wedge\D q^{i}$.

\begin{exercise}[{Torre~\cite{Torre:2022}}]
Prove the Symplectic two-form is non-degenerate.
[Hint: a 2-form $\Omega$ is non-degenerate if and only if
for every $v$ we have $\Omega(u,v)=0$ imply $u=0$.]
\end{exercise}

\begin{ddanger}
If we view the field as a mechanical system with infinitely many degrees
of freedom labeled by the spatial point $\vec{x}$, then we can view the
spatial integrals as continuous analogs to the various sums over dummy
indices. For this reason, physicists often call the components of the
initial data $\phi(\vec{x})$ the ``coordinate'' and $\varpi(\vec{x})$
the ``momentum'' for the scalar field. Usually physicists will switch
back and forth between the solutions $\varphi(t,\vec{x})$ with momenta
$\pi(t,\vec{x})$ and the initial data $(\phi(\vec{x}),\varpi(\vec{x}))$
without warning. Be warned! This especially happens when we consider a
foliation of spacetime by spatial hypersurfaces $t=\mbox{constant}$.
\end{ddanger}

\begin{exercise}[{Torre~\cite{Torre:2022}}]
For the Klein--Gordon equation $(\Box-\mu^{2})\varphi=0$, express the
Symplectic structure on the space of solutions in terms of the Fourier
parametrization
\begin{equation}
\varphi(t,\vec{x}) =
\int_{\RR^{3}}\left(a_{\vec{k}}\E^{\I(\vec{k}\cdot\vec{r}-\omega_{\vec{k}}t)}
+ a_{\vec{k}}^{*}\E^{-\I(\vec{k}\cdot\vec{r}-\omega_{\vec{k}}t)}
\right)\frac{\D^{3}k}{(2\pi)^{3/2}}.
\end{equation}
\end{exercise}

\N{Hamilton's Equations}
We can write down the Hamiltonian using our parametrization of $\Gamma$
in terms of initial data:
\begin{equation}
H[\phi,\varpi] = \int_{\RR^{3}}\left(\frac{1}{2}\varpi^{2} + \frac{1}{2}\nabla\phi\cdot\nabla\phi
+\frac{1}{2}\mu^{2}\phi^{2}+V(\phi)\right)\D^{3}x,
\end{equation}
where $\nabla$ is the usual spatial gradient.

The functional derivative can be determined using the Fre\'echet
differential
\begin{subequations}
\begin{align}
\variation H 
&=\int_{\RR^{3}}\left(\frac{\delta H[\phi,\varpi]}{\delta\varpi(\vec{x})}\delta\varpi(\vec{x})+\frac{\delta H[\phi,\varpi]}{\delta\phi(\vec{x})}\delta\phi(\vec{x})\right)\D^{3}x\\
&=\int_{\RR^{3}}\left(\varpi\,\delta\varpi
+\nabla\phi\cdot\nabla\delta\phi + \mu^{2}\phi\,\delta\phi + V'(\phi)\,\delta\phi\right)\D^{3}x.
\end{align}
We can integrate by parts in the terms with the gradients, using the
fact $\phi$ vanishes at infinity suitably nicely, to give us
\begin{equation}
\variation H =\int_{\RR^{3}}\left(\varpi\,\delta\varpi
+(-\nabla^{2}\phi + \mu^{2}\phi + V'(\phi))\,\delta\phi\right)\D^{3}x.
\end{equation}
\end{subequations}
This means in particular,
\begin{subequations}
\begin{align}
\frac{\delta H}{\delta\varpi(\vec{x})} &= \varpi(\vec{x}),\\
\intertext{and,}
\frac{\delta H}{\delta\phi(\vec{x})} &= -\nabla^{2}\phi + \mu^{2}\phi + V'(\phi).
\end{align}
\end{subequations}
Consequently, we see the field equations may be rewritten in the nifty
form:
\begin{subequations}
\begin{align}
\partial_{t}\phi &= \frac{\delta H}{\delta\varpi(\vec{x})}\\
\intertext{and,}
\partial_{t}\varpi &= -\frac{\delta H}{\delta\phi(\vec{x})}.
\end{align}
\end{subequations}
The reader should recognize these equations as Hamilton's equations.

\M
The derivation of Hamilton's equations in general, for fields, is
completely analogous to the situation for mechanics. We have the
Hamiltonian obtained by the Legendre transform of the Lagrangian
\begin{subequations}
\begin{align}
H &= \int_{\RR^{3}}\pi_{a}(\vec{x},t)\partial_{t}\varphi^{a}(\vec{x},t)\,\D^{3}x-L[\varphi^{a},\pi_{a}]\\
&= \int_{\RR^{3}}\bigl(\pi_{a}(\vec{x},t)\partial_{t}\varphi^{a}(\vec{x},t)-\mathcal{L}(\varphi^{a},\pi_{a})\bigr)\,\D^{3}x\\
&= \int_{\RR^{3}}\mathcal{H}(\varphi^{a},\pi_{a})\,\D^{3}x
\end{align}
\end{subequations}
The action in canonical form is then
\begin{subequations}
\begin{align}
\action &= \int^{t_{2}}_{t_{1}}\left(\int_{\RR^{3}}\pi_{a}(\vec{x},t)\partial_{t}\varphi^{a}(\vec{x},t)\,\D^{3}x-H\right)\,\D t\\
&= \int^{t_{2}}_{t_{1}}\int_{\RR^{3}}\bigl(\pi_{a}(\vec{x},t)\partial_{t}\varphi^{a}(\vec{x},t)-\mathcal{H}(\varphi^{a},\pi_{a})\bigr)\,\D^{3}x\,\D t
\end{align}
\end{subequations}
Stationary action then
\begin{calculation}
  \variation\action
\step{using canonical form of action}
\int^{t_{2}}_{t_{1}}\int_{\RR^{3}}\left(\partial_{t}\varphi^{a}(\vec{x},t)\,\variation\pi_{a}(\vec{x},t)
+\pi_{a}(\vec{x},t)\,\variation(\partial_{t}\varphi^{a}(\vec{x},t))
-\frac{\partial\mathcal{H}(\varphi^{a},\pi_{a})}{\partial\varphi^{a}}\variation\varphi^{a}(\vec{x},t)
-\frac{\partial\mathcal{H}(\varphi^{a},\pi_{a})}{\partial\pi_{a}}\variation\pi_{a}(\vec{x},t)
\right)\,\D^{3}x\,\D t
\step{using
  $\variation(\partial_{t}\varphi)=\partial_{t}(\variation\varphi)$ then
  integrate by parts, discarding boundary terms}
\int^{t_{2}}_{t_{1}}\int_{\RR^{3}}\left(\partial_{t}\varphi^{a}(\vec{x},t)\variation\pi_{a}(\vec{x},t)
-(\partial_{t}\pi_{a}(\vec{x},t))\,\variation\varphi^{a}(\vec{x},t)
-\frac{\partial\mathcal{H}(\varphi^{a},\pi_{a})}{\partial\varphi^{a}}\variation\varphi^{a}(\vec{x},t)
-\frac{\partial\mathcal{H}(\varphi^{a},\pi_{a})}{\partial\pi_{a}}\variation\pi_{a}(\vec{x},t)
\right)\,\D^{3}x\,\D t
\step{collecting terms}
\int^{t_{2}}_{t_{1}}\int_{\RR^{3}}\left(
\left(\partial_{t}\varphi^{a}(\vec{x},t)-\frac{\partial\mathcal{H}(\varphi^{a},\pi_{a})}{\partial\pi_{a}}\right)\variation\pi_{a}(\vec{x},t)
-\left(\partial_{t}\pi_{a}(\vec{x},t)+\frac{\partial\mathcal{H}(\varphi^{a},\pi_{a})}{\partial\varphi^{a}}\right)\,\variation\varphi^{a}(\vec{x},t)
\right)\,\D^{3}x\,\D t
\end{calculation}
The coefficients must vanish of $\variation\pi_{a}$ and
$\variation\varphi^{a}$ must separately vanish for each index $a$,
giving us Hamilton's equations:
\begin{subequations}
\begin{align}
\partial_{t}\varphi^{a}(\vec{x},t)&=\frac{\partial\mathcal{H}(\varphi^{a},\pi_{a})}{\partial\pi_{a}}\\
\partial_{t}\pi_{a}(\vec{x},t)&=-\frac{\partial\mathcal{H}(\varphi^{a},\pi_{a})}{\partial\varphi^{a}}.
\end{align}
\end{subequations}
We can use identities of functional derivatives to obtain Hamilton's
equations as:
\begin{subequations}
\begin{align}
\partial_{t}\varphi^{a}(\vec{x},t)&=\frac{\delta H[\varphi^{a},\pi_{a}]}{\delta\pi_{a}(\vec{x},t)}\\
\partial_{t}\pi_{a}(\vec{x},t)&=-\frac{\delta H[\varphi^{a},\pi_{a}]}{\delta\varphi_{a}(\vec{x},t)}.
\end{align}
\end{subequations}
This is true for any Hamiltonian which does not explicitly depend on
time (which is the case for almost all field theories we encounter in physics).

\N{References}
The discussion of Symplectic structure draws upon
Torre~\cite{Torre:2022}, section 3.2 of Abraham and Marsden~\cite{Abraham:1978},
and chapter 7 of Woodhouse~\cite{Woodhouse:1992de}.
The quartic self-interacting scalar field (i.e., with
$V(\varphi)=\lambda\varphi^{4}/4!$ where $\lambda$ is the coupling
constant) has a few known exact solutions, which are presented in
Frasca~\cite{Frasca:2009bc}. These are quite tricky, since it requires
knowledge of Jacobi elliptical functions.
